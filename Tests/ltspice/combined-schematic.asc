Version 4
SHEET 1 3940 1040
WIRE -288 -128 -288 -160
WIRE 912 -128 880 -128
WIRE 768 -112 736 -112
WIRE 880 -112 880 -128
WIRE 880 -112 832 -112
WIRE 880 -96 880 -112
WIRE -816 -80 -848 -80
WIRE -688 -80 -736 -80
WIRE -560 -80 -608 -80
WIRE 1200 -48 1152 -48
WIRE 1200 -32 1200 -48
WIRE -96 0 -96 -48
WIRE -80 0 -96 0
WIRE 32 0 0 0
WIRE 336 0 288 0
WIRE 416 0 416 -32
WIRE 416 0 336 0
WIRE 880 0 880 -16
WIRE -288 16 -288 -48
WIRE -816 32 -848 32
WIRE -672 32 -736 32
WIRE -96 48 -96 0
WIRE 336 48 336 0
WIRE 416 48 416 0
WIRE 1104 80 1072 80
WIRE 1200 80 1200 48
WIRE 1200 80 1184 80
WIRE 1408 80 1232 80
WIRE 1200 112 1200 80
WIRE 1232 112 1232 80
WIRE 784 128 720 128
WIRE 1152 144 1088 144
WIRE 1184 144 1152 144
WIRE 1280 144 1248 144
WIRE 1328 144 1280 144
WIRE 160 160 160 96
WIRE -96 176 -96 112
WIRE 336 176 336 112
WIRE 416 176 416 128
WIRE 1216 256 1216 176
WIRE 1408 256 1408 80
WIRE 1408 256 1216 256
WIRE -432 288 -528 288
WIRE -336 288 -432 288
WIRE -288 288 -336 288
WIRE 1216 288 1216 256
WIRE 784 304 736 304
WIRE 880 304 880 256
WIRE 880 304 848 304
WIRE -528 336 -528 288
WIRE -432 336 -432 288
WIRE -336 336 -336 288
WIRE 768 400 736 400
WIRE 880 400 880 304
WIRE 880 400 848 400
WIRE 928 400 880 400
WIRE 1216 416 1216 368
WIRE -928 448 -960 448
WIRE -816 448 -848 448
WIRE -704 448 -736 448
WIRE -528 448 -528 400
WIRE -528 448 -624 448
WIRE 320 480 320 432
WIRE 320 480 272 480
WIRE 336 480 320 480
WIRE 336 528 336 480
WIRE 336 528 304 528
WIRE 368 528 336 528
WIRE 304 560 304 528
WIRE 368 560 368 528
WIRE -960 576 -960 448
WIRE -928 576 -960 576
WIRE -816 576 -848 576
WIRE -704 576 -736 576
WIRE -432 576 -432 400
WIRE -432 576 -624 576
WIRE 272 656 272 480
WIRE 272 656 240 656
WIRE 304 656 304 624
WIRE 320 656 304 656
WIRE 368 656 368 624
WIRE 368 656 320 656
WIRE 800 656 800 624
WIRE 864 656 864 592
WIRE 864 656 800 656
WIRE 896 656 864 656
WIRE 992 656 976 656
WIRE 1104 656 1104 592
WIRE 1104 656 1072 656
WIRE 1120 656 1104 656
WIRE 1312 656 1312 608
WIRE 1312 656 1216 656
WIRE 800 688 800 656
WIRE -960 704 -960 576
WIRE -928 704 -960 704
WIRE -816 704 -848 704
WIRE -704 704 -736 704
WIRE -336 704 -336 400
WIRE -336 704 -624 704
WIRE -80 704 -80 672
WIRE -16 704 -80 704
WIRE 112 704 64 704
WIRE 272 704 240 704
WIRE 336 704 272 704
WIRE 496 704 480 704
WIRE 512 704 512 608
WIRE 512 704 496 704
WIRE 512 720 512 704
WIRE 1200 736 1200 704
WIRE 1216 736 1200 736
WIRE -528 752 -528 448
WIRE -432 752 -432 576
WIRE -336 752 -336 704
WIRE 112 752 48 752
WIRE 272 752 272 704
WIRE 272 752 240 752
WIRE 336 784 336 704
WIRE 384 784 336 784
WIRE 496 784 496 704
WIRE 496 784 464 784
WIRE 800 784 800 752
WIRE 864 784 864 656
WIRE 944 784 864 784
WIRE 1104 784 1104 656
WIRE 1104 784 1008 784
WIRE 320 800 320 656
WIRE 320 800 240 800
WIRE 512 800 320 800
WIRE 512 848 512 800
WIRE 528 848 512 848
WIRE -528 864 -528 816
WIRE -432 864 -432 816
WIRE -432 864 -528 864
WIRE -336 864 -336 816
WIRE -336 864 -432 864
WIRE -288 864 -336 864
FLAG -96 -48 18V
IOPIN -96 -48 Out
FLAG 416 -32 5V
IOPIN 416 -32 Out
FLAG 336 176 0
FLAG -96 176 0
FLAG -80 672 3V3_PWM
IOPIN -80 672 In
FLAG 48 752 0
FLAG 320 432 18V
IOPIN 320 432 In
FLAG 512 608 Gate_Signal
IOPIN 512 608 Out
FLAG 1216 736 Gate_Signal
IOPIN 1216 736 Out
FLAG -848 -80 0
FLAG -560 -80 18V
IOPIN -560 -80 Out
FLAG 800 624 REC+
IOPIN 800 624 Out
FLAG -848 32 0
FLAG -672 32 3V3_PWM
IOPIN -672 32 Out
FLAG -288 288 REC+
IOPIN -288 288 Out
FLAG 1312 608 REC-
IOPIN 1312 608 Out
FLAG -288 864 REC-
IOPIN -288 864 Out
FLAG 864 592 A+
IOPIN 864 592 Out
FLAG 1104 592 A-
IOPIN 1104 592 Out
FLAG 416 176 0
FLAG -960 576 0
FLAG 800 784 REC-
IOPIN 800 784 Out
FLAG 528 848 REC-
IOPIN 528 848 Out
FLAG 1216 416 0
FLAG 1088 144 0
FLAG 1328 144 18V
IOPIN 1328 144 Out
FLAG 1072 80 0
FLAG -288 -160 0
FLAG -288 16 CSENSE
IOPIN -288 16 Out
FLAG 1152 -48 CSENSE
IOPIN 1152 -48 In
FLAG 1280 208 0
FLAG 1152 208 0
FLAG 160 160 0
FLAG 912 -128 18V
IOPIN 912 -128 Out
FLAG 736 -112 0
FLAG 720 128 0
FLAG 736 304 0
FLAG 736 400 0
FLAG 928 400 12V
IOPIN 928 400 Out
SYMBOL ZZZ\\VolReg\\LM7805-1 160 0 R0
SYMATTR InstName U1
SYMBOL cap 320 48 R0
SYMATTR InstName C1
SYMATTR Value 0.1µ
SYMATTR SpiceLine V=10 Irms=0 Rser=0.0163 Lser=375p mfg="Würth Elektronik" pn="885012207016 WCAP-CSGP 0805" type="X7R"
SYMBOL cap -112 48 R0
WINDOW 3 -35 56 Left 2
SYMATTR InstName C2
SYMATTR Value 0.33µ
SYMBOL ZZZ\\OPTO\\HCPL-3120 176 720 R0
SYMATTR InstName U3
SYMBOL res 80 688 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R10
SYMATTR Value 220
SYMBOL cap 288 560 R0
SYMATTR InstName C4
SYMATTR Value 0.01µ
SYMATTR SpiceLine V=25 Irms=0 Rser=0.0262 Lser=534p mfg="Würth Elektronik" pn="885012008030 WCAP-CSGP 1206" type="NP0"
SYMBOL cap 352 560 R0
SYMATTR InstName C5
SYMATTR Value 0.1µ
SYMATTR SpiceLine V=50 Irms=0 Rser=0.0808 Lser=1.08n mfg="Würth Elektronik" pn="885382208003 WCAP-CSST 1206" type="X7R"
SYMBOL res 496 688 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R11
SYMATTR Value 220
SYMBOL nmos 1120 704 R270
SYMATTR InstName M1
SYMATTR Value IPB65R420CFD
SYMBOL diode 1008 768 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D1
SYMBOL voltage -592 -80 R90
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V5
SYMATTR Value 18
SYMBOL voltage -720 -80 R90
WINDOW 3 -53 34 VRight 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR Value SINE(0.05 0.1 100000)
SYMATTR InstName V6
SYMBOL voltage -720 32 R90
WINDOW 0 -32 56 VBottom 2
WINDOW 3 32 56 VTop 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V3
SYMATTR Value PULSE(0 3.3 1n 1n 1n 0.25m 0.5m)
SYMBOL voltage -832 448 R90
WINDOW 0 -32 56 VBottom 2
WINDOW 3 32 56 VTop 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V7
SYMATTR Value SINE(0 109 50)
SYMBOL voltage -832 576 R90
WINDOW 0 -32 56 VBottom 2
WINDOW 3 32 56 VTop 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V8
SYMATTR Value SINE(0 109 50 0 0 -120)
SYMBOL voltage -832 704 R90
WINDOW 0 -32 56 VBottom 2
WINDOW 3 32 56 VTop 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V9
SYMATTR Value SINE(0 109 50 0 0 120)
SYMBOL res -720 432 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R9
SYMATTR Value 0.001
SYMBOL ind -608 432 R90
WINDOW 0 5 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName L2
SYMATTR Value 10µ
SYMBOL res -720 560 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R13
SYMATTR Value 0.001
SYMBOL ind -608 560 R90
WINDOW 0 5 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName L3
SYMATTR Value 10µ
SYMBOL res -720 688 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R14
SYMATTR Value 0.001
SYMBOL ind -608 688 R90
WINDOW 0 5 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName L4
SYMATTR Value 10µ
SYMBOL diode -512 400 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D2
SYMBOL diode -416 400 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D3
SYMBOL diode -320 400 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D4
SYMBOL diode -512 816 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D5
SYMBOL diode -320 816 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D7
SYMBOL diode -416 816 R180
WINDOW 0 24 64 Left 2
WINDOW 3 24 0 Left 2
SYMATTR InstName D6
SYMBOL polcap 816 688 M0
SYMATTR InstName C6
SYMATTR Value 940µ
SYMATTR Description Capacitor
SYMATTR Type cap
SYMATTR SpiceLine V=450 Irms=1.94 Rser=0.001 Lser=8n
SYMBOL res 992 640 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R1
SYMATTR Value 0.8
SYMBOL ind 1088 640 R90
WINDOW 0 5 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName L1
SYMATTR Value 12.5m
SYMBOL res 400 32 R0
SYMATTR InstName R15
SYMATTR Value 30
SYMBOL res 496 704 R0
SYMATTR InstName R4
SYMATTR Value 22
SYMBOL diode 400 688 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName D8
SYMATTR Value 1N4148
SYMBOL res 368 800 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R5
SYMATTR Value 220
SYMBOL res 1232 384 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R2
SYMATTR Value 440
SYMBOL ZZZ\\OpAmp\\LM358_TI 1216 144 R90
SYMATTR InstName U2
SYMBOL res 1216 64 R180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R3
SYMATTR Value 22k
SYMBOL res 1200 64 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R6
SYMATTR Value 39k
SYMBOL voltage -288 -32 R180
WINDOW 0 24 96 Left 2
WINDOW 3 24 16 Left 2
WINDOW 123 0 0 Left 0
WINDOW 39 0 0 Left 0
SYMATTR InstName V1
SYMATTR Value 4.5
SYMBOL cap 1296 208 R180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C3
SYMATTR Value 10n
SYMBOL cap 1168 208 R180
WINDOW 0 24 56 Left 2
WINDOW 3 24 8 Left 2
SYMATTR InstName C7
SYMATTR Value 10n
SYMBOL ZZZ\\VolReg\\LM7812 880 128 R90
SYMATTR InstName U4
SYMBOL cap 832 -128 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C8
SYMATTR Value 0.33µ
SYMBOL cap 848 288 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C9
SYMATTR Value 0.1µ
SYMBOL res 864 384 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R7
SYMATTR Value 171
SYMBOL res 864 -112 R0
SYMATTR InstName R8
SYMATTR Value 1
SYMBOL res 16 -16 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R12
SYMATTR Value 1
TEXT 1040 -168 Left 2 ;Current sensing
TEXT -112 -168 Left 2 ;Voltage regulator - 5V
TEXT -112 392 Left 2 ;Isolated gate driver
TEXT 704 488 Left 2 ;Buck converter test
TEXT -1040 -168 Left 2 ;Test inputs
TEXT -1040 288 Left 2 ;Three phase full bridge rectifier
TEXT 432 200 Left 1 ;Pico model \nfor low power \noperation
TEXT -1056 944 Left 2 !.tran 0 60m 0 50u
TEXT -1040 144 Left 1 ;CSENSE is analog voltages between 2.5V and 4.5V.\nWhile current is zero it gives 2.5V analog voltage signal\nand it increases with 66mV/A.
TEXT 1040 -120 Left 1 ;Since ADC channels of the pico works with\nmaximum of 3.3V, CSENSE must be lowered.
TEXT 704 -168 Left 2 ;Voltage regulator - 12V
LINE Normal 1040 448 1040 448 2
LINE Normal 1056 448 1040 448 2
LINE Normal 1024 448 1024 -192 4
RECTANGLE Normal 1424 448 688 -192 4
RECTANGLE Normal 640 896 -128 368 4
RECTANGLE Normal -160 896 -1056 256 4
RECTANGLE Normal 1424 464 688 896 4
RECTANGLE Normal 544 256 384 16 4
RECTANGLE Normal -128 -192 640 336 4
RECTANGLE Normal -160 -192 -1056 224 4
